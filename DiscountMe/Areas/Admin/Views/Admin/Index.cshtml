@model IList<MembershipUser>

@{
	ViewBag.Title = "User Administration";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2 class="mvcMembership">Gestión de usuarios</h2>

<div class="mvcMembership-allUsers">
    @if(Model.Any()) {
        <ul class="mvcMembership mvcMembership-users">
            @foreach(var user in Model) {
                <li>
                    <span class="mvcMembership-username">@Html.ActionLink(user.UserName, "Details", "Admin", new{ id = user.ProviderUserKey})</span>
                    <span class="mvcMembership-email"><a href="mailto:@user.Email">@user.Email</a></span>
                    @if(user.IsOnline) {
                        <span class="mvcMembership-isOnline">Online</span>
                    }
                    else {
                        <span class="mvcMembership-isOffline">Offline for
                            @{
                                var offlineSince = (DateTime.Now - user.LastActivityDate);
                                if (offlineSince.TotalSeconds <= 60) {
                                    <text>1 minute.</text>
                                }
                                else if(offlineSince.TotalMinutes < 60) {
                                    <text>@Math.Floor(offlineSince.TotalMinutes) minutes.</text>
                                }
                                else if (offlineSince.TotalMinutes < 120) {
                                    <text>1 hour</text>
                                }
                                else if (offlineSince.TotalHours < 24) {
                                    <text>@Math.Floor(offlineSince.TotalHours) hours.</text>
                                }
                                else if (offlineSince.TotalHours < 48) {
                                    <text>1 day.</text>
                                }
                                else {
                                    <text>@Math.Floor(offlineSince.TotalDays) days.</text>
                                }
                            }
                        </span>
                    }
                    @if(!string.IsNullOrEmpty(user.Comment)){
                        <span class="mvcMembership-comment">@user.Comment</span>
                    }
                </li>
            }
        </ul>
    }
    else {
        <p>No users have registered.</p>
    }
</div>